# -*- coding: utf-8 -*-
"""PATRICK KARIUKI CYBER SHUJAA TASK : REGRESSION MODEL.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1JX_vVljLTvSVP4XYDmXXOyaU-jYnMMBI

PATRICK KIMATHI KARIUKI
Student ID: CS-DA02-25041
TASK : Assignment 7: Regression Models
DATE: 02,NOVEMBER 2025
"""

#import the relevant libraries
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')
#import libraries for machine learning model
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

"""#Import/load the data set from the local machine"""

#Import/load the data set from the local machine
from google.colab import files
uploaded = files.upload()



#confrim that the files have been unploaded
import os
print(os.listdir())

#Load my dataset to a DataFrame
homeprices_df = pd.read_csv('homeprices.csv')
homeprices_df.head()

"""# Explore the Dataset

*Describe* its structure, and visualize it using scatter plots
"""

#DISCOVER THE DATA STRUCTURE
homeprices_df.info()

#display summary statistics
homeprices_df.describe()

"""**Visualize** it using scatter plots"""

#Visualize the data using Scatter plot
plt.figure(figsize=(10,6))
sns.scatterplot( data=homeprices_df, x='area', y='price')
plt.title('Scatter Plot of Area vs Price', color='red')
plt.xlabel('Area (Square feet)')
plt.ylabel('Price(USD)')
plt.grid(True)
plt.show()

"""# Prepare the Data"""

#check if there are missing values in the dataset
homeprices_df.isnull().sum()

"""Split the dataset into training and test sets"""

#split the dataset into training and test sets
X = homeprices_df.drop('price', axis=1) # drop the target variable to remain with the features
y = homeprices_df['price']
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42) #the tes-size is split  25% of the dataset meaning the train split is 75

#print the train split
print("X_Train", X_train)
print("Y_Traing(Price)\n", y_train)

#Visualize the train set using scatterplot
plt.figure(figsize=(10,6))
sns.scatterplot(x=X_train['area'], y=y_train)
plt.title('Scatter Plot of Train split Area vs Price', color='red')
plt.xlabel('Area (Square feet)')
plt.ylabel('Price(USD)')
plt.grid(True)
plt.show()

#Visualize the test split using scatter plot
plt.figure(figsize=(10,6))
sns.scatterplot(x=X_test['area'], y=y_test)
plt.title('Scatter Plot of Test split Area vs Price', color='red')
plt.xlabel('Area (Square feet)')
plt.ylabel('Price(USD)')
plt.grid(True)
plt.show()

#print the test split
print("X_Test(Area)", X_test)
print("Y_Test(Price)\n", y_test)

"""# Build the Model

**Use** Scikit-learn’s LinearRegression to fit the model on training data
"""

#: Use Scikit-learn’s LinearRegression to fit the model on training data
model = LinearRegression()
model.fit(X_train, y_train) #fit the model

"""# Evaluate the Model: Use metrics like MAE, MSE, RMSE, and R² Score"""

#Evaluate the Model: Use metrics like MAE, MSE, RMSE, and R² Score
y_pred = model.predict(X_test) #predict
mse = mean_squared_error(y_test, y_pred) #mean squared error between the predicted and actual target value
rmse = np.sqrt(mse)
r2 = r2_score(y_test, y_pred)

"""Print the metrics **bold text**"""

#Print the results
print("Mean Squared Error:", mse)
print("Root Mean Squared Error:", rmse)
print("R-squared Score:", r2)

"""The mean squared error (MSE) is a measure of the average squared difference between the predicted and actual target values in the Linear Regression model. It is commonly used as a performance metric to evaluate the accuracy of the model's predictions on the test set. A lower value of MSE indicates that the model has better predictive power, as it means that the predicted values are closer to the actual values. Therefore, the purpose of the mean squared error in the Linear Regression model is to assess the quality of the model's predictions and to determine if it needs to be further optimized.*italicised text*

The R2 value of 92% shows a good model fit

A high R-Squared value means that many data points are close to the linear regression function line.
A low R-Squared value means that the linear regression function line does not fit the data well.*italicised text*

The high R-Squared value of 0.92  means that many data points are close to the linear regression function line.
**bold text**

# Visualize the Results

Plot the regression line against the actual **data**
"""

#Plot the regression line against the actual data
plt.figure(figsize=(10,6))
plt.scatter(X_test, y_test, color='blue', label='Actual Data')
plt.plot(X_test, y_pred, color='red', linewidth=2, label='Regression Line')
plt.title('Actual Data vs Regression Line', color='red')
plt.xlabel('Area (Square feet)')
plt.ylabel('Price(USD)')
plt.legend()
plt.grid(True)
plt.show()

"""This simple Linear regression demonstrates that:

Price is positively correlated with area.

The model effectively captures the linear pattern in the given data.

However, since it’s based on only two data points, the model’s predictive reliability is limited — it would need more data to generalize well.
"""

#download the csv file
homeprices_df.to_csv('homeprices.csv', index=False)

#download to a specific folder
from google.colab import files
files.download('homeprices.csv')